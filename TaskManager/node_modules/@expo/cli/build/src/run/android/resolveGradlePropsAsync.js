"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "resolveGradlePropsAsync", {
    enumerable: true,
<<<<<<< HEAD
    get: function() {
        return resolveGradlePropsAsync;
    }
});
function _path() {
    const data = /*#__PURE__*/ _interop_require_default(require("path"));
=======
    get: ()=>resolveGradlePropsAsync
});
function _path() {
    const data = /*#__PURE__*/ _interopRequireDefault(require("path"));
>>>>>>> 0823204efb84884a0322b43e865bb36631ba8251
    _path = function() {
        return data;
    };
    return data;
}
const _adb = require("../../start/platforms/android/adb");
const _errors = require("../../utils/errors");
<<<<<<< HEAD
function _interop_require_default(obj) {
=======
function _interopRequireDefault(obj) {
>>>>>>> 0823204efb84884a0322b43e865bb36631ba8251
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
// Supported ABIs for Android. see https://developer.android.com/ndk/guides/abis
const VALID_ARCHITECTURES = [
<<<<<<< HEAD
    'armeabi-v7a',
    'arm64-v8a',
    'x86',
    'x86_64'
];
function assertVariant(variant) {
    if (variant && typeof variant !== 'string') {
        throw new _errors.CommandError('BAD_ARGS', '--variant must be a string');
    }
    return variant ?? 'debug';
=======
    "armeabi-v7a",
    "arm64-v8a",
    "x86",
    "x86_64"
];
function assertVariant(variant) {
    if (variant && typeof variant !== "string") {
        throw new _errors.CommandError("BAD_ARGS", "--variant must be a string");
    }
    return variant != null ? variant : "debug";
>>>>>>> 0823204efb84884a0322b43e865bb36631ba8251
}
async function resolveGradlePropsAsync(projectRoot, options, device) {
    const variant = assertVariant(options.variant);
    // NOTE(EvanBacon): Why would this be different? Can we get the different name?
<<<<<<< HEAD
    const appName = 'app';
    const apkDirectory = _path().default.join(projectRoot, 'android', appName, 'build', 'outputs', 'apk');
    // buildDeveloperTrust -> buildtype: trust, flavors: build, developer
    // developmentDebug -> buildType: debug, flavors: development
    // productionRelease -> buildType: release, flavors: production
    // This won't work for non-standard flavor names like "myFlavor" would be treated as "my", "flavor".
    const flavors = variant.split(/(?=[A-Z])/).map((v)=>v.toLowerCase());
    const buildType = flavors.pop() ?? 'debug';
=======
    const appName = "app";
    const apkDirectory = _path().default.join(projectRoot, "android", appName, "build", "outputs", "apk");
    // buildDeveloperTrust -> build, developer, trust (where developer, and trust are flavors).
    // This won't work for non-standard flavor names like "myFlavor" would be treated as "my", "flavor".
    const [buildType, ...flavors] = variant.split(/(?=[A-Z])/).map((v)=>v.toLowerCase());
>>>>>>> 0823204efb84884a0322b43e865bb36631ba8251
    const apkVariantDirectory = _path().default.join(apkDirectory, ...flavors, buildType);
    const architectures = await getConnectedDeviceABIS(buildType, device, options.allArch);
    return {
        appName,
        buildType,
        flavors,
        apkVariantDirectory,
        architectures
    };
}
async function getConnectedDeviceABIS(buildType, device, allArch) {
    // Follow the same behavior as iOS, only enable this for debug builds
<<<<<<< HEAD
    if (allArch || buildType !== 'debug') {
        return '';
    }
    const abis = await (0, _adb.getDeviceABIsAsync)(device);
    const validAbis = abis.filter((abi)=>VALID_ARCHITECTURES.includes(abi));
    return validAbis.filter((abi, i, arr)=>arr.indexOf(abi) === i).join(',');
=======
    if (allArch || buildType !== "debug") {
        return "";
    }
    const abis = await (0, _adb.getDeviceABIsAsync)(device);
    const validAbis = abis.filter((abi)=>VALID_ARCHITECTURES.includes(abi));
    return validAbis.filter((abi, i, arr)=>arr.indexOf(abi) === i).join(",");
>>>>>>> 0823204efb84884a0322b43e865bb36631ba8251
}

//# sourceMappingURL=resolveGradlePropsAsync.js.map
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: all[name]
    });
}
_export(exports, {
<<<<<<< HEAD
    getCssModulesFromBundler: function() {
        return getCssModulesFromBundler;
    },
    getFileName: function() {
        return getFileName;
    }
});
function _crypto() {
    const data = /*#__PURE__*/ _interop_require_default(require("crypto"));
=======
    getCssModulesFromBundler: ()=>getCssModulesFromBundler,
    getFileName: ()=>getFileName
});
function _crypto() {
    const data = /*#__PURE__*/ _interopRequireDefault(require("crypto"));
>>>>>>> 0823204efb84884a0322b43e865bb36631ba8251
    _crypto = function() {
        return data;
    };
    return data;
}
function _js() {
<<<<<<< HEAD
    const data = require("metro/src/DeltaBundler/Serializers/helpers/js.js");
=======
    const data = require("metro/src/DeltaBundler/Serializers/helpers/js");
>>>>>>> 0823204efb84884a0322b43e865bb36631ba8251
    _js = function() {
        return data;
    };
    return data;
}
function _splitBundleOptions() {
<<<<<<< HEAD
    const data = /*#__PURE__*/ _interop_require_default(require("metro/src/lib/splitBundleOptions"));
=======
    const data = /*#__PURE__*/ _interopRequireDefault(require("metro/src/lib/splitBundleOptions"));
>>>>>>> 0823204efb84884a0322b43e865bb36631ba8251
    _splitBundleOptions = function() {
        return data;
    };
    return data;
}
function _path() {
<<<<<<< HEAD
    const data = /*#__PURE__*/ _interop_require_default(require("path"));
=======
    const data = /*#__PURE__*/ _interopRequireDefault(require("path"));
>>>>>>> 0823204efb84884a0322b43e865bb36631ba8251
    _path = function() {
        return data;
    };
    return data;
}
<<<<<<< HEAD
function _interop_require_default(obj) {
=======
function _interopRequireDefault(obj) {
>>>>>>> 0823204efb84884a0322b43e865bb36631ba8251
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
// s = static
<<<<<<< HEAD
const STATIC_EXPORT_DIRECTORY = '_expo/static/css';
async function getCssModulesFromBundler(config, incrementalBundler, options) {
    // Static CSS is a web-only feature.
    if (options.platform !== 'web') {
        return [];
    }
    const { entryFile, onProgress, resolverOptions, transformOptions } = (0, _splitBundleOptions().default)(options);
=======
const STATIC_EXPORT_DIRECTORY = "_expo/static/css";
async function getCssModulesFromBundler(config, incrementalBundler, options) {
    // Static CSS is a web-only feature.
    if (options.platform !== "web") {
        return [];
    }
    const { entryFile , onProgress , resolverOptions , transformOptions  } = (0, _splitBundleOptions().default)(options);
>>>>>>> 0823204efb84884a0322b43e865bb36631ba8251
    const dependencies = await incrementalBundler.getDependencies([
        entryFile
    ], transformOptions, resolverOptions, {
        onProgress,
<<<<<<< HEAD
        shallow: false,
        lazy: false
    });
=======
        shallow: false
    });
    var _unstable_serverRoot;
>>>>>>> 0823204efb84884a0322b43e865bb36631ba8251
    return getCssModules(dependencies, {
        processModuleFilter: config.serializer.processModuleFilter,
        assetPlugins: config.transformer.assetPlugins,
        platform: transformOptions.platform,
<<<<<<< HEAD
        projectRoot: config.server.unstable_serverRoot ?? config.projectRoot,
=======
        projectRoot: (_unstable_serverRoot = config.server.unstable_serverRoot) != null ? _unstable_serverRoot : config.projectRoot,
>>>>>>> 0823204efb84884a0322b43e865bb36631ba8251
        publicPath: config.transformer.publicPath
    });
}
function hashString(str) {
<<<<<<< HEAD
    return _crypto().default.createHash('md5').update(str).digest('hex');
}
function getCssModules(dependencies, { processModuleFilter, projectRoot }) {
    const promises = [];
    for (const module of dependencies.values()){
        if ((0, _js().isJsModule)(module) && processModuleFilter(module) && (0, _js().getJsOutput)(module).type === 'js/module' && _path().default.relative(projectRoot, module.path) !== 'package.json') {
=======
    return _crypto().default.createHash("md5").update(str).digest("hex");
}
function getCssModules(dependencies, { processModuleFilter , projectRoot  }) {
    const promises = [];
    for (const module of dependencies.values()){
        if ((0, _js().isJsModule)(module) && processModuleFilter(module) && (0, _js().getJsOutput)(module).type === "js/module" && _path().default.relative(projectRoot, module.path) !== "package.json") {
>>>>>>> 0823204efb84884a0322b43e865bb36631ba8251
            const cssMetadata = getCssMetadata(module);
            if (cssMetadata) {
                const contents = cssMetadata.code;
                const filename = _path().default.join(// Consistent location
                STATIC_EXPORT_DIRECTORY, // Hashed file contents + name for caching
<<<<<<< HEAD
                getFileName(module.path) + '-' + hashString(module.path + contents) + '.css');
=======
                getFileName(module.path) + "-" + hashString(module.path + contents) + ".css");
>>>>>>> 0823204efb84884a0322b43e865bb36631ba8251
                promises.push({
                    originFilename: _path().default.relative(projectRoot, module.path),
                    filename,
                    source: contents
                });
            }
        }
    }
    return promises;
}
function getCssMetadata(module) {
<<<<<<< HEAD
    var _module_output_;
    const data = (_module_output_ = module.output[0]) == null ? void 0 : _module_output_.data;
    if (data && typeof data === 'object' && 'css' in data) {
        if (typeof data.css !== 'object' || !('code' in data.css)) {
=======
    var ref;
    const data = (ref = module.output[0]) == null ? void 0 : ref.data;
    if (data && typeof data === "object" && "css" in data) {
        if (typeof data.css !== "object" || !("code" in data.css)) {
>>>>>>> 0823204efb84884a0322b43e865bb36631ba8251
            throw new Error(`Unexpected CSS metadata in Metro module (${module.path}): ${JSON.stringify(data.css)}`);
        }
        return data.css;
    }
    return null;
}
function getFileName(module) {
<<<<<<< HEAD
    return _path().default.basename(module).replace(/\.[^.]+$/, '');
=======
    return _path().default.basename(module).replace(/\.[^.]+$/, "");
>>>>>>> 0823204efb84884a0322b43e865bb36631ba8251
}

//# sourceMappingURL=getCssModulesFromBundler.js.map
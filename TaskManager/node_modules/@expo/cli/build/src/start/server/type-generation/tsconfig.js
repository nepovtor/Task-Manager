"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: all[name]
    });
}
_export(exports, {
<<<<<<< HEAD
    forceRemovalTSConfig: function() {
        return forceRemovalTSConfig;
    },
    forceUpdateTSConfig: function() {
        return forceUpdateTSConfig;
    },
    getTSConfigRemoveUpdates: function() {
        return getTSConfigRemoveUpdates;
    },
    getTSConfigUpdates: function() {
        return getTSConfigUpdates;
    }
});
function _jsonfile() {
    const data = /*#__PURE__*/ _interop_require_default(require("@expo/json-file"));
    _jsonfile = function() {
=======
    forceUpdateTSConfig: ()=>forceUpdateTSConfig,
    getTSConfigUpdates: ()=>getTSConfigUpdates,
    forceRemovalTSConfig: ()=>forceRemovalTSConfig,
    getTSConfigRemoveUpdates: ()=>getTSConfigRemoveUpdates
});
function _jsonFile() {
    const data = /*#__PURE__*/ _interopRequireDefault(require("@expo/json-file"));
    _jsonFile = function() {
>>>>>>> 0823204efb84884a0322b43e865bb36631ba8251
        return data;
    };
    return data;
}
function _chalk() {
<<<<<<< HEAD
    const data = /*#__PURE__*/ _interop_require_default(require("chalk"));
=======
    const data = /*#__PURE__*/ _interopRequireDefault(require("chalk"));
>>>>>>> 0823204efb84884a0322b43e865bb36631ba8251
    _chalk = function() {
        return data;
    };
    return data;
}
function _path() {
<<<<<<< HEAD
    const data = /*#__PURE__*/ _interop_require_default(require("path"));
=======
    const data = /*#__PURE__*/ _interopRequireDefault(require("path"));
>>>>>>> 0823204efb84884a0322b43e865bb36631ba8251
    _path = function() {
        return data;
    };
    return data;
}
const _log = require("../../../log");
<<<<<<< HEAD
function _interop_require_default(obj) {
=======
function _interopRequireDefault(obj) {
>>>>>>> 0823204efb84884a0322b43e865bb36631ba8251
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
async function forceUpdateTSConfig(projectRoot) {
    // This runs after the TypeScript prerequisite, so we know the tsconfig.json exists
<<<<<<< HEAD
    const tsConfigPath = _path().default.join(projectRoot, 'tsconfig.json');
    const { tsConfig, updates } = getTSConfigUpdates(_jsonfile().default.read(tsConfigPath, {
=======
    const tsConfigPath = _path().default.join(projectRoot, "tsconfig.json");
    const { tsConfig , updates  } = getTSConfigUpdates(_jsonFile().default.read(tsConfigPath, {
>>>>>>> 0823204efb84884a0322b43e865bb36631ba8251
        json5: true
    }));
    await writeUpdates(tsConfigPath, tsConfig, updates);
}
function getTSConfigUpdates(tsConfig) {
    const updates = new Set();
    if (!tsConfig.include) {
        tsConfig.include = [
<<<<<<< HEAD
            '**/*.ts',
            '**/*.tsx',
            '.expo/types/**/*.ts',
            'expo-env.d.ts'
        ];
        updates.add('include');
    } else if (Array.isArray(tsConfig.include)) {
        if (!tsConfig.include.includes('.expo/types/**/*.ts')) {
            tsConfig.include = [
                ...tsConfig.include,
                '.expo/types/**/*.ts'
            ];
            updates.add('include');
        }
        if (!tsConfig.include.includes('expo-env.d.ts')) {
            tsConfig.include = [
                ...tsConfig.include,
                'expo-env.d.ts'
            ];
            updates.add('include');
=======
            "**/*.ts",
            "**/*.tsx",
            ".expo/types/**/*.ts",
            "expo-env.d.ts"
        ];
        updates.add("include");
    } else if (Array.isArray(tsConfig.include)) {
        if (!tsConfig.include.includes(".expo/types/**/*.ts")) {
            tsConfig.include = [
                ...tsConfig.include,
                ".expo/types/**/*.ts"
            ];
            updates.add("include");
        }
        if (!tsConfig.include.includes("expo-env.d.ts")) {
            tsConfig.include = [
                ...tsConfig.include,
                "expo-env.d.ts"
            ];
            updates.add("include");
>>>>>>> 0823204efb84884a0322b43e865bb36631ba8251
        }
    }
    return {
        tsConfig,
        updates
    };
}
async function forceRemovalTSConfig(projectRoot) {
    // This runs after the TypeScript prerequisite, so we know the tsconfig.json exists
<<<<<<< HEAD
    const tsConfigPath = _path().default.join(projectRoot, 'tsconfig.json');
    const { tsConfig, updates } = getTSConfigRemoveUpdates(_jsonfile().default.read(tsConfigPath, {
=======
    const tsConfigPath = _path().default.join(projectRoot, "tsconfig.json");
    const { tsConfig , updates  } = getTSConfigRemoveUpdates(_jsonFile().default.read(tsConfigPath, {
>>>>>>> 0823204efb84884a0322b43e865bb36631ba8251
        json5: true
    }));
    await writeUpdates(tsConfigPath, tsConfig, updates);
}
function getTSConfigRemoveUpdates(tsConfig) {
    const updates = new Set();
    if (Array.isArray(tsConfig.include)) {
<<<<<<< HEAD
        const filtered = tsConfig.include.filter((i)=>i !== 'expo-env.d.ts' && i !== '.expo/types/**/*.ts');
        if (filtered.length !== tsConfig.include.length) {
            updates.add('include');
=======
        const filtered = tsConfig.include.filter((i)=>i !== "expo-env.d.ts" && i !== ".expo/types/**/*.ts");
        if (filtered.length !== tsConfig.include.length) {
            updates.add("include");
>>>>>>> 0823204efb84884a0322b43e865bb36631ba8251
        }
        tsConfig.include = filtered;
    }
    return {
        tsConfig,
        updates
    };
}
async function writeUpdates(tsConfigPath, tsConfig, updates) {
    if (updates.size) {
<<<<<<< HEAD
        await _jsonfile().default.writeAsync(tsConfigPath, tsConfig);
=======
        await _jsonFile().default.writeAsync(tsConfigPath, tsConfig);
>>>>>>> 0823204efb84884a0322b43e865bb36631ba8251
        for (const update of updates){
            _log.Log.log((0, _chalk().default)`{bold TypeScript}: The {cyan tsconfig.json#${update}} property has been updated`);
        }
    }
}

//# sourceMappingURL=tsconfig.js.map